# Makefile for busybox
#
# Copyright (C) 1999-2004 by Erik Andersen <andersen@codepoet.org>
#
# Licensed under the GPL v2 or later, see the file LICENSE in this tarball.

srcdir=$(top_srcdir)/archival/libunarchive
objdir=$(top_builddir)/archival/libunarchive

LIBUNARCHIVE-y:= \
\
	data_skip \
	data_extract_all \
	data_extract_to_stdout \
	data_extract_to_buffer \
\
	filter_accept_all \
	filter_accept_list \
	filter_accept_reject_list \
\
	header_skip \
	header_list \
	header_verbose_list \
\
	archive_xread_all \
	archive_xread_all_eof \
\
	seek_by_char \
	seek_by_jump \
\
	data_align \
	find_list_entry \
	open_transformer \
	init_handle

GUNZIP_FILES:= check_header_gzip decompress_unzip
DPKG_FILES:= \
	get_header_ar \
	unpack_ar_archive \
	get_header_tar \
	filter_accept_list_reassign

LIBUNARCHIVE-$(CONFIG_AR) += get_header_ar unpack_ar_archive
LIBUNARCHIVE-$(CONFIG_BUNZIP2) += decompress_bunzip2
LIBUNARCHIVE-$(CONFIG_UNLZMA) += decompress_unlzma
LIBUNARCHIVE-$(CONFIG_CPIO) += get_header_cpio
LIBUNARCHIVE-$(CONFIG_DPKG) += $(DPKG_FILES)
LIBUNARCHIVE-$(CONFIG_DPKG_DEB) += $(DPKG_FILES)
LIBUNARCHIVE-$(CONFIG_FEATURE_DEB_TAR_GZ) += $(GUNZIP_FILES) get_header_tar_gz
LIBUNARCHIVE-$(CONFIG_FEATURE_DEB_TAR_BZ2) += decompress_bunzip2 get_header_tar_bz2
LIBUNARCHIVE-$(CONFIG_FEATURE_DEB_TAR_LZMA) += decompress_unlzma get_header_tar_lzma
LIBUNARCHIVE-$(CONFIG_GUNZIP) += $(GUNZIP_FILES)
LIBUNARCHIVE-$(CONFIG_FEATURE_GUNZIP_UNCOMPRESS) += decompress_uncompress
LIBUNARCHIVE-$(CONFIG_RPM2CPIO) += $(GUNZIP_FILES) get_header_cpio
LIBUNARCHIVE-$(CONFIG_RPM) += $(GUNZIP_FILES) get_header_cpio
LIBUNARCHIVE-$(CONFIG_TAR) += get_header_tar
LIBUNARCHIVE-$(CONFIG_FEATURE_TAR_BZIP2) += decompress_bunzip2 get_header_tar_bz2
LIBUNARCHIVE-$(CONFIG_FEATURE_TAR_LZMA) += decompress_unlzma get_header_tar_lzma
LIBUNARCHIVE-$(CONFIG_FEATURE_TAR_GZIP) += $(GUNZIP_FILES) get_header_tar_gz
LIBUNARCHIVE-$(CONFIG_FEATURE_TAR_COMPRESS) += decompress_uncompress
LIBUNARCHIVE-$(CONFIG_UNCOMPRESS) += decompress_uncompress
LIBUNARCHIVE-$(CONFIG_UNZIP) += $(GUNZIP_FILES)


LIBUNARCHIVE-y:=$(sort $(LIBUNARCHIVE-y))

LIBUNARCHIVE_SRC-y:=$(patsubst %,$(srcdir)/%.c,$(LIBUNARCHIVE-y))
LIBUNARCHIVE_SRC-a:=$(wildcard $(srcdir)/*.c)
LIBRARY_SRC-y+=$(LIBUNARCHIVE_SRC-y)
LIBRARY_SRC-a+=$(LIBUNARCHIVE_SRC-a)

archival_libunarchive_OBJ$(os):=$(patsubst %,$(objdir)/%$(os),$(LIBUNARCHIVE-y))


# Makefile for busybox
#
# Copyright (C) 1999-2005 by Erik Andersen <andersen@codepoet.org>
#
# Licensed under the GPL v2, see the file LICENSE in this tarball.

srcdir:=$(top_srcdir)/util-linux
objdir:=$(top_builddir)/util-linux

UTIL-LINUX-$(CONFIG_DMESG)         +=dmesg.o
UTIL-LINUX-$(CONFIG_FBSET)         +=fbset.o
UTIL-LINUX-$(CONFIG_FDFLUSH)       +=fdflush.o
UTIL-LINUX-$(CONFIG_FDFORMAT)      +=fdformat.o
UTIL-LINUX-$(CONFIG_FDISK)         +=fdisk.o
UTIL-LINUX-$(CONFIG_FREERAMDISK)   +=freeramdisk.o
UTIL-LINUX-$(CONFIG_FSCK_MINIX)    +=fsck_minix.o
UTIL-LINUX-$(CONFIG_GETOPT)        +=getopt.o
UTIL-LINUX-$(CONFIG_HEXDUMP)       +=hexdump.o
UTIL-LINUX-$(CONFIG_HWCLOCK)       +=hwclock.o
UTIL-LINUX-$(CONFIG_IPCRM)         +=ipcrm.o
UTIL-LINUX-$(CONFIG_IPCS)          +=ipcs.o
UTIL-LINUX-$(CONFIG_LOSETUP)       +=losetup.o
UTIL-LINUX-$(CONFIG_MDEV)          +=mdev.o
UTIL-LINUX-$(CONFIG_MKFS_MINIX)    +=mkfs_minix.o
UTIL-LINUX-$(CONFIG_MKSWAP)        +=mkswap.o
UTIL-LINUX-$(CONFIG_MORE)          +=more.o
UTIL-LINUX-$(CONFIG_MOUNT)         +=mount.o
UTIL-LINUX-$(CONFIG_FEATURE_MOUNT_NFS)	+=nfsmount.o
UTIL-LINUX-$(CONFIG_PIVOT_ROOT)    +=pivot_root.o
UTIL-LINUX-$(CONFIG_RDATE)         +=rdate.o
UTIL-LINUX-$(CONFIG_READPROFILE)   +=readprofile.o
UTIL-LINUX-$(CONFIG_SETARCH)       +=setarch.o
UTIL-LINUX-$(CONFIG_SWAPONOFF)     +=swaponoff.o
UTIL-LINUX-$(CONFIG_SWITCH_ROOT)   +=switch_root.o
UTIL-LINUX-$(CONFIG_UMOUNT)        +=umount.o


UTILLINUX_SRC-y:=$(patsubst %.o,$(srcdir)/%.c,$(UTIL-LINUX-y))
UTILLINUX_SRC-a:=$(wildcard $(srcdir)/*.c)
APPLET_SRC-y+=$(UTILLINUX_SRC-y)
APPLET_SRC-a+=$(UTILLINUX_SRC-a)

ifneq ($(strip $(CONFIG_LFS)),y)
ifeq ($(strip $(FDISK_SUPPORT_LARGE_DISKS)),y)
CFLAGS-util-linux-fdisk.c := -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64
endif
endif

util-linux_OBJ:=  $(patsubst %,$(objdir)/%,$(UTIL-LINUX-y))

$(util-linux_OBJ): $(objdir)/%.o: $(srcdir)/%.c
$(objdir)/util-linux.a: $(util-linux_OBJ)
libraries-y:=$(libraries-y) $(objdir)/util-linux.a

